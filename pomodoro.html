<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>少女风番茄时钟</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Mochiy+Pop+One&family=Noto+Sans+SC:wght@400;700&display=swap');
        body {
            font-family: 'Mochiy+Pop+One', 'Noto Sans SC', sans-serif;
            -webkit-tap-highlight-color: transparent;
            overflow: hidden; /* 防止出现滚动条 */
        }
        .btn {
            transition: all 0.2s ease-in-out;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn-active {
            background-color: #ec4899 !important;
            color: white !important;
            box-shadow: 0 2px 8px rgba(236, 72, 153, 0.4);
        }
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23fce7f3' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            z-index: -1;
        }
    </style>
</head>
<body class="bg-pink-50 flex items-center justify-center min-h-screen">
    <main class="bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl p-8 sm:p-12 w-11/12 max-w-md text-center">
        <div class="flex justify-center items-center mb-4">
            <svg class="h-16 w-16 text-pink-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14.86,8.23h.01" fill="#ec4899"></path><path d="M9.14,8.23h.01" fill="#ec4899"></path><path d="M12,12.51a.45.45,0,0,1-.45-.45,1,1,0,0,1,1,1A.45.45,0,0,1,12,12.51Z" fill="#ec4899"></path><path d="M12.54,12.51a.45.45,0,0,1-.45-.45,1,1,0,0,1,1,1A.45.45,0,0,1,12.54,12.51Z" fill="#ec4899" transform="rotate(90 12.5 12.5)"></path><path d="M12,2A10,10,0,0,0,2,12a9.89,9.89,0,0,0,2.47,6.55,1,1,0,0,1,.22.68l-.4,2.84a1,1,0,0,0,1.1,1.1l2.84-.4a1,1,0,0,1,.68.22A9.89,9.89,0,0,0,12,22a10,10,0,0,0,0-20Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"></path><path d="M15.73,4.27a1,1,0,0,0,1-1,4,4,0,0,0-8,0,1,1,0,0,0,1,1Z"></path>
            </svg>
        </div>
        <h1 class="text-2xl sm:text-3xl font-bold text-pink-500 mb-2">番茄工作法</h1>
        <p id="mode-indicator" class="text-gray-500 mb-8 font-sans">选择一个模式开始</p>
        <div class="flex justify-center space-x-4 mb-8">
            <button id="work-btn" class="btn bg-pink-100 text-pink-700 font-semibold py-2 px-6 rounded-full focus:outline-none">工作</button>
            <button id="break-btn" class="btn bg-pink-100 text-pink-700 font-semibold py-2 px-6 rounded-full focus:outline-none">休息</button>
        </div>
        <div id="timer-display" class="text-7xl sm:text-8xl font-bold text-pink-500 my-8 tabular-nums">25:00</div>
        <div class="flex justify-center items-center space-x-4">
            <button id="start-pause-btn" class="btn bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full text-lg focus:outline-none" disabled>开始</button>
            <button id="reset-btn" class="btn bg-pink-200 hover:bg-pink-300 text-pink-800 font-bold p-3 rounded-full focus:outline-none" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"/></svg>
            </button>
        </div>
        <div class="mt-10 pt-6 border-t border-pink-100">
            <h2 class="text-lg font-semibold text-pink-500">统计</h2>
            <p class="text-gray-500 mt-2 font-sans">已完成的番茄钟: <span id="pomodoros-completed" class="font-bold text-pink-500">0</span></p>
        </div>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const timerDisplay = document.getElementById('timer-display');
            const modeIndicator = document.getElementById('mode-indicator');
            const startPauseBtn = document.getElementById('start-pause-btn');
            const resetBtn = document.getElementById('reset-btn');
            const workBtn = document.getElementById('work-btn');
            const breakBtn = document.getElementById('break-btn');
            const completedCountSpan = document.getElementById('pomodoros-completed');
            const WORK_MINUTES = 25;
            const BREAK_MINUTES = 5;
            let timerId = null;
            let timeLeftInSeconds = WORK_MINUTES * 60;
            let isPaused = true;
            let currentMode = null;
            let pomodorosCompleted = 0;
            const synth = new Tone.MetalSynth({frequency: 200,envelope: { attack: 0.001, decay: 0.1, release: 0.1 },harmonicity: 5.1,modulationIndex: 32,resonance: 4000,octaves: 1.5}).toDestination();
            function updateDisplay() {
                const minutes = Math.floor(timeLeftInSeconds / 60);
                const seconds = timeLeftInSeconds % 60;
                timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                document.title = `${timerDisplay.textContent} - 番茄钟`;
            }
            function playCompletionSound() {
                if (Tone.context.state !== 'running') {
                    Tone.context.resume();
                }
                synth.triggerAttackRelease("C6", "0.1", Tone.now());
                synth.triggerAttackRelease("E6", "0.1", Tone.now() + 0.15);
            }
            function switchMode(mode) {
                currentMode = mode;
                isPaused = true;
                clearInterval(timerId);
                timerId = null;
                if (mode === 'work') {
                    timeLeftInSeconds = WORK_MINUTES * 60;
                    modeIndicator.textContent = '是时候专注工作啦！';
                    workBtn.classList.add('btn-active');
                    breakBtn.classList.remove('btn-active');
                } else {
                    timeLeftInSeconds = BREAK_MINUTES * 60;
                    modeIndicator.textContent = '休息一下，放松心情吧~';
                    breakBtn.classList.add('btn-active');
                    workBtn.classList.remove('btn-active');
                }
                updateDisplay();
                startPauseBtn.textContent = '开始';
                startPauseBtn.disabled = false;
                resetBtn.disabled = false;
            }
            function toggleTimer() {
                if (currentMode === null) return;
                isPaused = !isPaused;
                if (!isPaused) {
                    startPauseBtn.textContent = '暂停';
                    timerId = setInterval(() => {
                        timeLeftInSeconds--;
                        updateDisplay();
                        if (timeLeftInSeconds <= 0) {
                            clearInterval(timerId);
                            playCompletionSound();
                            if (currentMode === 'work') {
                                pomodorosCompleted++;
                                completedCountSpan.textContent = pomodorosCompleted;
                                switchMode('break');
                            } else {
                                switchMode('work');
                            }
                        }
                    }, 1000);
                } else {
                    startPauseBtn.textContent = '继续';
                    clearInterval(timerId);
                }
            }
            function resetTimer() {
                if (currentMode === null) return;
                switchMode(currentMode);
            }
            startPauseBtn.addEventListener('click', toggleTimer);
            resetBtn.addEventListener('click', resetTimer);
            workBtn.addEventListener('click', () => switchMode('work'));
            breakBtn.addEventListener('click', () => switchMode('break'));
            switchMode('work');
        });
    </script>
</body>
</html>
